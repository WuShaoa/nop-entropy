# 1 术语和缩略语
| 术语 | 说明 |
|------|------|
| SDLC | 软件开发生命周期 |
| API | 应用程序编程接口 |
| ERP | 企业资源计划系统 |
| BOM | 物料清单 |

# 2 需求概述
本系统旨在建设一套食堂物资管理系统，整合菜单管理、成本核算、订餐系统以及物资出入库管理等环节，实现数据的实时共享与精准分析，为食堂的高效运营提供有力支撑，进而为学校师生打造更加优质、便捷的餐饮服务环境。系统分为“服务公司”和“学校管理员”两类角色，不同角色具有不同的操作权限。

# 3 系统功能需求

## 3.1 用户角色与权限
| 角色 | 权限 | 操作范围 |
|------|------|----------|
| 学校管理员 | 基础数据维护、日常监管、成本核算、统计报表查看 | 物资管理、供应商管理、服务公司管理、基础菜单管理、出入库数据查看、统计报表查看 |
| 服务公司 | 日常经营数据录入、出入库管理、菜单管理、供应商结算、盘库管理 | 库房管理、每日菜单管理、出入库管理、供应商结算、盘库管理、经营数据录入 |

## 3.2 核心功能模块

### 3.2.1 基础数据管理(Priority:1,Effort:2)
实现基础数据的维护与管理，包括物资管理、供应商管理、服务公司管理、基础菜单管理等，仅学校管理员有操作权限。

####  子功能列表
- **物资管理**  
  实现物资的新增、编辑、删除及查询操作，支持以物资和时间为维度的查询统计，如物资出入库数据、库存等。

- **供应商管理**  
  实现供应商的添加、修改、删除操作，支持以供应商和时间为维度的查询统计，如供应商供货入库明细、账单结算等。

- **服务公司管理**  
  实现服务公司的新增、编辑、删除及查询操作，支持查询服务公司的出入库明细、库存、操作明细等。

- **基础菜单管理**  
  实现基础菜单的新增、编辑、删除及查询操作，支持从基础菜单中选择每日菜单，菜单信息包含配餐材料及其成本信息。

### 3.2.2 库房管理(Priority:2,Effort:1)
服务公司对各自库房进行管理，包括库房的新增、编辑、删除操作。

####  子功能列表
- **库房信息维护**  
  支持库房编码、库房名称、所属公司、备注等字段的维护。

### 3.2.3 每日菜单管理(Priority:2,Effort:1)
服务公司对每日菜单进行管理，包括新增、编辑、删除及查询操作，菜单只能从基础菜单中选择，且在结算日不可编辑或删除。

####  子功能列表
- **每日菜单维护**  
  支持菜单日期、类别、菜单编码、菜单名称、菜单图片、菜单配料等字段的维护。

### 3.2.4 入出库管理(Priority:1,Effort:3)
服务公司对出入库进行管理，支持新增、编辑、删除及查询操作，出入库明细包含物资编码、名称、单价、数量、金额等。

####  子功能列表
- **出入库操作**  
  支持所属服务公司、出入库编码、出入库日期、库房、经手人、供应商、已付金额、合计金额、出入库明细、附件材料等字段的维护。
  
- **出入库锁定机制**  
  支持有权限的用户对数据进行锁定，锁定后的数据不能编辑或删除。

### 3.2.5 盘库管理(Priority:3,Effort:1)
服务公司可进行盘库操作，对库存误差进行盘库入库及盘库出库操作。

####  子功能列表
- **盘库操作**  
  支持对库存误差进行盘库入库及盘库出库操作。

### 3.2.6 供应商结算(Priority:2,Effort:1)
服务公司以入库单为依据与供应商进行结算，每项数据包含总金额、已结金额等信息。

####  子功能列表
- **结算数据维护**  
  支持结算数据的录入与查询，包含总金额、已结金额等字段。

### 3.2.7 经营数据管理(Priority:2,Effort:2)
服务公司对经营数据进行管理录入，包括订餐人数、经营成本、日偏差数据等。

####  子功能列表
- **订餐人数管理**  
  支持从第三方API自动读取订餐人数，或手工录入，作为物资消耗和成本核算的依据。

- **经营成本管理**  
  支持录入服务公司每日的固定成本，包括水电费、人员工资、房租成本等。

- **日偏差数据计算**  
  支持根据每日出库单和成本核算，自动计算偏差数据。

# 4 核心数据库表
| 表名 | 中文名 | 说明 | 主要字段 |
|------|--------|------|----------|
| `material` | 物资表 | 存储食堂所用的各类食材信息 | 物资编码、物资名称、计量单位、规格型号、物资图片、品牌、备注 |
| `supplier` | 供应商表 | 存储各类食材的供货单位信息 | 供应商编码、供应商名称、社会信用代码、食品安全安全认证、联系人信息、企业简介、备注、状态 |
| `service_company` | 服务公司表 | 存储学校食堂的经营单位信息 | 公司编码、公司名称、社会信用代码、食品安全安全认证、联系人信息、企业简介、备注、状态 |
| `menu` | 基础菜单表 | 存储学校食堂的基础菜单信息 | 菜单编号、菜单名称、菜单类型、菜单图片、配餐材料、备注 |
| `daily_menu` | 每日菜单表 | 存储服务公司每日菜单信息 | 菜单日期、类别、菜单编码、菜单名称、菜单图片、菜单配料 |
| `warehouse` | 库房表 | 存储服务公司的库房信息 | 库房编码、库房名称、所属公司、备注 |
| `in_out_stock` | 入出库表 | 存储出入库记录信息 | 出入库编码、出入库日期、库房、经手人、供应商、已付金额、合计金额、附件材料 |
| `in_out_detail` | 入出库明细表 | 存储出入库明细信息 | 物资编码、物资名称、规格、单位、单价、数量、金额 |
| `inventory_check` | 盘库表 | 存储盘库操作记录信息 | 盘库编码、盘库日期、库房、经手人、盘库类型、差异金额 |
| `operating_data` | 经营数据表 | 存储服务公司的经营数据信息 | 经营日期、服务公司、订餐人数、经营成本、日偏差数据 |

# 5 接口设计

## 5.1 依赖的REST服务接口
| 服务对象名 | 说明 |
|------------|------|
| 第三方API | 提供订餐人数数据，支持读取和查询 |

## 5.2 提供的REST服务接口
| 服务对象名 | 说明 |
|------------|------|
| 物资管理接口 | 提供物资信息的增删改查功能 |
| 供应商管理接口 | 提供供应商信息的增删改查功能 |
| 服务公司管理接口 | 提供服务公司信息的增删改查功能 |
| 基础菜单管理接口 | 提供基础菜单信息的增删改查功能 |
| 每日菜单管理接口 | 提供每日菜单信息的增删改查功能 |
| 库房管理接口 | 提供库房信息的增删改查功能 |
| 入出库管理接口 | 提供出入库信息的增删改查功能 |
| 盘库管理接口 | 提供盘库信息的增删改查功能 |
| 经营数据管理接口 | 提供经营数据信息的增删改查功能 |

# 6 非功能需求

## 6.1 性能需求
- 系统需支持并发访问，满足1000个并发用户的请求。
- 数据查询响应时间不超过2秒。
- 数据更新操作需在1秒内完成。

## 6.2 安全需求
- 所有操作需进行权限验证，确保只有授权用户才能进行相应操作。
- 敏感数据需进行加密存储，如供应商信息、服务公司信息等。
- 系统需记录操作日志，支持审计和追踪。

## 6.3 合规需求
- 系统需符合《信息安全技术 信息系统安全等级保护基本要求》（GB/T 22239-2019）。
- 系统需支持数据备份与恢复，确保数据安全。
- 系统需支持数据脱敏处理，确保隐私数据不被泄露。

## 6.4 其他需求
- 系统需支持多语言切换，至少包含中文、英文。
- 系统需提供操作指引和帮助文档，方便用户使用。
- 系统需支持移动端访问，适配主流移动设备。

# 7 原始需求中的额外要求
- 物资入库时已禁用的供应商将不出现在选择列表中，其历史数据将会保留。
- 已禁用的服务公司不能再登录使用系统，但历史数据将会保留。
- 每日菜单不能再进行编辑及删除操作，如果菜单日期已纳入结算日。
- 出入库操作时，有权限的用户可锁定数据，已锁定的数据不能再编辑和删除。
- 服务公司的每日菜单只能从基础菜单中进行选择，如有缺少需通知学校管理员补充录入。
- 附件材料（入库时需将供应商提供的票据作为附件上传）。
- 供应商结算以入库单为依据，每项数据包含总金额、已结金额等。
- 日偏差数据是指根据每日出库单、每日成本核算，自动计算偏差。

