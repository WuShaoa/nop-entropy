<meta x:extends="super" x:schema="/nop/schema/xmeta.xdef"
      xmlns:x="/nop/schema/xdsl.xdef" xmlns:graphql="graphql" xmlns:filter="filter">

    <props>
        <prop name="extConfig">
            <auth roles="manager,hr" for="read"/>
            <auth roles="hr" for="write"/>
        </prop>

        <prop name="createTime" allowFilterOp="eq,in,ge" />

        <prop name="resourcesList" displayName="资源列表" graphql:queryMethod="findList">
            <schema bizObjName="NopAuthResource" />

            <graphql:filter>
                <eq name="siteId" value="@prop-ref:siteId" />
            </graphql:filter>

            <graphql:orderBy>
                <field name="orderNo" desc="false" />
            </graphql:orderBy>
        </prop>

        <prop name="resourcesConnection" displayName="资源列表"
              graphql:queryMethod="findPage" graphql:connectionProp="resources">
            <schema bizObjName="NopAuthResource" />
        </prop>

        <prop name="myCustomFilter" queryable="true">
            <graphql:transFilter>
                <filter:sql>
                    exists(select o2 from NopAuthResource o2 where o2.siteId= o.id
                     and o2.status >= ${filter.getAttr('value')})
                </filter:sql>
            </graphql:transFilter>
        </prop>
    </props>
</meta>