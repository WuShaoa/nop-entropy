<task x:schema="/nop/schema/task/task.xdef" xmlns:x="/nop/schema/xdsl.xdef"
      x:extends="/nop/task/lib/common.task.xml,/nop/task/lib/batch-base.task.xml"
      xmlns:task="task" x:dump="true" defaultUseParentScope="true" xmlns:xpl="xpl">

    <input name="totalCount" type="int"/>
    <input name="taskKey" type="String"/>

    <steps>
        <custom name="createCard" customType="batch:Execute"
                xmlns:batch="/nop/batch/xlib/batch.xlib">
            <batch:task taskName="demo.createCard" batchSize="100" saveState="true" useBatchRequestGenerator="true">
                <taskKeyExpr>taskKey</taskKeyExpr>

                <loader>
                    <generator genModelPath="create-card.batch-gen.xlsx" totalCountExpr="totalCount"/>
                </loader>

                <processor name="callCreateCardTask">
                    <source>
                        <task:Execute taskName="demo/create-card" inputs="${{request:item,consume}}"
                            xpl:lib="/nop/task/xlib/task.xlib"/>
                    </source>
                </processor>

                <!-- processor中调用ORM保存实体，这里不需要额外配置consumer -->

            </batch:task>
        </custom>
    </steps>
</task>